{
  "$comment": "DDR3-1600K (11-11-11-28) — 2Gb x8 device, single rank, JEDEC-compliant default configuration",
  "$schema": "https://example.com/ddr3_microarchitecture.schema.json",

  "memory_geometry": {
    "row_bits": 14,
    "column_bits": 10,
    "bank_bits": 3,
    "ranks": 1,
    "burst_length": 8,
    "device_width_bits": 8,
    "byte_lanes": 2,
    "address_mapping": "row-bank-column",

    "$derived": {
      "device_density": "2Gb (2^14 rows × 2^10 cols × 8 banks × 8 bits = 2,147,483,648 bits)",
      "page_size_bytes": "1 KB (2^10 cols × 8 bits / 8 = 1024 bytes per device)",
      "total_data_width_bits": 16,
      "burst_transfer_bytes": 16,
      "channel_bandwidth_MBps": "12800 (1600 MT/s × 2 bytes)"
    }
  },

  "timing_model": {
    "$comment_speed_bin": "DDR3-1600K speed bin. All values in nCK (controller clock cycles at 800 MHz). tCK = 1.25 ns.",

    "tRCD": 11,
    "tRP": 11,
    "tRAS": 28,
    "tRC": 39,
    "tRFC": 128,
    "tFAW": 32,
    "tRRD": 6,
    "tWR": 12,
    "tWTR": 6,
    "tRTP": 6,
    "tCCD": 4,
    "tREFI": 6240,
    "CAS_latency": 11,
    "CAS_write_latency": 8,

    "$jedec_compliance_checks": {
      "tRC_rule": "tRC >= tRAS + tRP → 39 >= 28 + 11 = 39 ✓",
      "tRAS_rule": "tRAS >= CL + tRCD + tRP - 1 → 28 >= 11 + 11 + 11 - 1 = 32 — NOTE: JEDEC minimum tRAS is 35ns = 28 nCK at 800MHz. tRAS here is the JEDEC spec value, not the overclocking formula.",
      "tFAW_rule": "tFAW >= 4 × tRRD → 32 >= 4 × 6 = 24 ✓ (JEDEC min 40ns = 32 nCK for 1KB page)",
      "tRFC_rule": "tRFC = 160ns for 2Gb density → 160ns / 1.25ns = 128 nCK ✓",
      "tREFI_rule": "tREFI = 7.8us / 1.25ns = 6240 nCK ✓ (JEDEC standard refresh interval)",
      "tWR_rule": "tWR = 15ns → ceil(15 / 1.25) = 12 nCK ✓",
      "tRTP_rule": "tRTP = max(4 nCK, 7.5ns) → max(4, 6) = 6 nCK ✓",
      "tWTR_rule": "tWTR = max(4 nCK, 7.5ns) → max(4, 6) = 6 nCK ✓",
      "tRRD_rule": "tRRD = max(4 nCK, 7.5ns) for 1KB page → max(4, 6) = 6 nCK ✓",
      "tCCD_rule": "tCCD = 4 nCK (BL8, always 4 for DDR3) ✓",
      "CWL_rule": "CWL = 8 for DDR3-1600 (tCK 1.25ns bin) per JEDEC table ✓"
    }
  },

  "clocking_model": {
    "controller_clock_period_ps": 5000,
    "ddr_clock_period_ps": 1250,
    "clock_ratio": 4,
    "pipeline_latency_cycles": 2,

    "$derived": {
      "controller_frequency_mhz": "200 MHz (1 / 5000ps)",
      "ddr_clock_frequency_mhz": "800 MHz (1 / 1250ps)",
      "data_rate_mt_s": "1600 MT/s (DDR = 2 × 800 MHz)",
      "ratio_check": "ddr_clock / controller_clock = 5000 / 1250 = 4 ✓"
    }
  },

  "controller_architecture": {
    "num_ports": 1,
    "scheduler_policy": "fr_fcfs",
    "row_policy": "open_page",
    "command_queue_depth": 16,
    "lookahead_depth": 8,
    "ecc_mode": 0,
    "self_refresh_mode": "auto",
    "enable_bist": true,
    "enable_second_wishbone": false,
    "aux_width": 4
  },

  "initialization_sequence": {
    "reset_hold_us": 200,
    "cke_delay_us": 500,
    "tXPR_cycles": 136,
    "mode_registers": {
      "MR0": {
        "burst_length": "fixed_8",
        "cas_latency": 11,
        "dll_reset": true,
        "write_recovery": 12,
        "precharge_pd_mode": "fast_exit"
      },
      "MR1": {
        "dll_enable": true,
        "output_drive_strength": "RZQ_6",
        "rtt_nom": "RZQ_4",
        "additive_latency": "disabled",
        "write_leveling_enable": false
      },
      "MR2": {
        "cas_write_latency": 8,
        "rtt_wr": "RZQ_4",
        "self_refresh_temperature": "normal",
        "auto_self_refresh": false
      },
      "MR3": {
        "mpr_enable": false,
        "mpr_read_function": 0
      }
    },
    "zq_calibration_on_init": true,
    "tZQinit_cycles": 512,

    "$jedec_compliance_checks": {
      "reset_hold": "200us meets JEDEC minimum 200us ✓",
      "cke_delay": "500us meets JEDEC minimum 500us after RESET# deassert ✓",
      "tXPR": "max(5 nCK, tRFC+10ns) = max(5, 128+ceil(10/1.25)) = max(5, 136) = 136 nCK ✓",
      "MR0_WR_match": "MR0.write_recovery (12) matches timing_model.tWR (12) ✓",
      "MR0_CL_match": "MR0.cas_latency (11) matches timing_model.CAS_latency (11) ✓",
      "MR2_CWL_match": "MR2.cas_write_latency (8) matches timing_model.CAS_write_latency (8) ✓",
      "tZQinit": "512 nCK meets JEDEC minimum 512 nCK ✓",
      "init_sequence_order": "RESET# → wait 200us → CKE high → wait 500us → tXPR → MR2 → MR3 → MR1 → MR0(DLL reset) → ZQCL ✓"
    }
  },

  "calibration": {
    "enable_write_leveling": true,
    "enable_read_leveling": true,
    "enable_bitslip_training": true,
    "read_delay_scan_range": {
      "min_taps": 0,
      "max_taps": 31,
      "step": 1
    },
    "write_delay_scan_range": {
      "min_taps": 0,
      "max_taps": 31,
      "step": 1
    },
    "training_pattern": "mpr_predefined",
    "calibration_retry_count": 3,
    "periodic_recalibration_enable": true,
    "periodic_zqcs_interval_cycles": 512000,

    "$derived": {
      "zqcs_interval_ns": "512000 × 1.25ns = 640us (well within JEDEC 128ms max interval for ZQCS)"
    }
  },

  "host_interface": {
    "data_width_bits": 32,
    "address_width_bits": 27,
    "granularity_bits": 8,
    "interface_type": "wishbone_pipelined",
    "burst_type": "linear",
    "max_burst_length": 8,
    "read_buffer_depth": 16,
    "write_buffer_depth": 16,
    "enable_data_mask": true,

    "$derived": {
      "addressable_space_bytes": "2^27 = 128 MB (matches 2Gb device / 8 bits × 1 rank × 2 byte_lanes ÷ some overhead for ECC=0)",
      "burst_transfer_bytes": "32 bits × 8 words / 8 = 32 bytes per burst"
    }
  },

  "implementation_targets": {
    "target_frequency_mhz": 200,
    "area_optimization_goal": "balanced",
    "power_optimization_goal": "balanced"
  }
}
